## 程序性能

异步的目的之一是提升性能，包括用户体验性能。

### Web Worker
浏览器或其他宿主环境模拟多线程环境。

* 实例化一个Worker，指向一个js文件，浏览器为这个文件单开一个线程
* Worker之间以及它们和主程序之间，不会共享任何作用域或资源
* Worker和宿主是一对一的关系，可以有子Worker

#### Worker环境
完全独立的环境。

* 可以执行网络操作、设置定时器、访问几个重要的全局变量和功能的本地复本。有提议把canvas加进去。
* 可以加载其他js文件，但是是同步的。
* 通常用于密集型数学计算、大数据集排序、复杂数据处理、高流量网络通信

#### 数据传递
在线程中通过事件机制需要进行大量数据的通信。

* 使用结构化克隆算法。
* 使用Transferable对象,把数据所有权转移。像Uint8Array这样的带类型的数组就是Transferable的。
```
// 比如foo是一个Uint8Array  
 
postMessage( foo.buffer, [ foo.buffer ] ); 
```

#### 共享Worker
减轻应用压力。共享Worker可以与站点的多个程序实例或多个页面连接。

* 通过端口标识，必须使用Worker的port对象用于通信，然后监听connect事件。多个端口连接就实现了共享。

#### 模拟Web Worker
可使用定时器（setTimeout(..)等）强制模拟实现异步的伪Worker。作者实现了一套。

### SIMD
单指令多数据（SIMD）,并行处理数据。

* 涉及到CPU,类似调用汇编指令。对计算来说可以提升性能。

### asm.js
JavaScript语言中可以高度优化的一个子集。理论上可以自动优化代码。

#### 如何使用asm.js优化
反正会忽略类型转换或者垃圾收集等难以优化的步骤。

#### asm.js模块
对JavaScript性能影响最大的因素是内存分配、垃圾收集和作用域访问。

* 需要导入明确的命名空间和一个堆。
* ams.js模块和ES6模块应该是隔离的。
* 也是高度优化的程序语言交叉编译的一个很好的目标。	